{% extends "layouts/base.html" %}
{% load crispy_forms_filters %}

{% block title %} Task list {% endblock %}


<!-- Specific Page CSS goes HERE  -->
{#{% block stylesheets %}{% endblock stylesheets %}#}

{% block content %}

  {% include 'includes/navigation.html' %}
  <header class="bg-gradient-dark">
    <div class="page-header min-vh-75" style="background-image: url('{{ ASSETS_ROOT }}/img/bg9.jpg');">
      <span class="mask bg-gradient-dark opacity-6"></span>
      <div class="container">
        <div class="row justify-content-center">
          <div class="col-lg-8 text-center mx-auto my-auto">
            <h1 class="text-white">
              Worker list
            </h1>
          </div>
        </div>
      </div>
    </div>
    </div>
  </header>

  <div class="card card-body shadow-xl mx-3 mx-md-4 mt-n6">
  <!-- Section with four info areas left & one card right with image and waves -->
  <section class="py-7">
    <div class="container">
      <div class="row align-items-center">
        <h1>Workers list
          <a href="{% url 'manager:workers-create' %}" class="btn btn-primary link-to-page">
            Create
          </a>
        </h1>

        <br>
        <form action="" method="get">
          {{ search_form|crispy }}
          <input class="btn btn-primary" type="submit" value="Search">
        </form>
        <br>

        {% if worker_list %}
          <table class="table">
            <tr>
              <th>ID</th>
              <th>Username</th>
              <th>First name</th>
              <th>Last name</th>
              <th>Position</th>
            </tr>
            {% for worker in worker_list %}
              <tr>
                <td>{{ worker.id }}</td>
                <td><a href="{% url 'manager:workers-detail' pk=worker.id %}">{{ worker.username }}</a></td>
                <td>{{ worker.first_name }}</td>
                <td>{{ worker.last_name }}</td>
                <td>{{ worker.position }}</td>
              </tr>
            {% endfor %}
            {% else %}
            <p>There are no one worker</p>
          </table>
        {% endif %}
      </div>
    </div>
  </section>
  <!-- END Section with four info areas left & one card right with image and waves -->


{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}

  <script>
      // get the element to animate
      var element = document.getElementById('count-stats');
      var elementHeight = element.clientHeight;

      // listen for scroll event and call animate function

      document.addEventListener('scroll', animate);

      // check if element is in view
      function inView() {
          // get window height
          var windowHeight = window.innerHeight;
          // get number of pixels that the document is scrolled
          var scrollY = window.scrollY || window.pageYOffset;
          // get current scroll position (distance from the top of the page to the bottom of the current viewport)
          var scrollPosition = scrollY + windowHeight;
          // get element position (distance from the top of the page to the bottom of the element)
          var elementPosition = element.getBoundingClientRect().top + scrollY + elementHeight;

          // is scroll position greater than element position? (is element in view?)
          if (scrollPosition > elementPosition) {
              return true;
          }

          return false;
      }

      var animateComplete = true;

      // animate element when it is in view
      function animate() {

          // is element in view?
          if (inView()) {
              if (animateComplete) {
                  if (document.getElementById('state1')) {
                      const countUp = new CountUp('state1', document.getElementById("state1").getAttribute("countTo"));
                      if (!countUp.error) {
                          countUp.start();
                      } else {
                          console.error(countUp.error);
                      }
                  }
                  if (document.getElementById('state2')) {
                      const countUp1 = new CountUp('state2', document.getElementById("state2").getAttribute("countTo"));
                      if (!countUp1.error) {
                          countUp1.start();
                      } else {
                          console.error(countUp1.error);
                      }
                  }
                  if (document.getElementById('state3')) {
                      const countUp2 = new CountUp('state3', document.getElementById("state3").getAttribute("countTo"));
                      if (!countUp2.error) {
                          countUp2.start();
                      } else {
                          console.error(countUp2.error);
                      }
                      ;
                  }
                  animateComplete = false;
              }
          }
      }

      if (document.getElementById('typed')) {
          var typed = new Typed("#typed", {
              stringsElement: '#typed-strings',
              typeSpeed: 90,
              backSpeed: 90,
              backDelay: 200,
              startDelay: 500,
              loop: true
          });
      }
  </script>

  <script>
      if (document.getElementsByClassName('page-header')) {
          window.onscroll = debounce(function () {
              var scrollPosition = window.pageYOffset;
              var bgParallax = document.querySelector('.page-header');
              var oVal = (window.scrollY / 3);
              bgParallax.style.transform = 'translate3d(0,' + oVal + 'px,0)';
          }, 6);
      }
  </script>

{% endblock javascripts %}
